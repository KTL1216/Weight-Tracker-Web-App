{"files":[{"id":"f3d653f5-b05e-41ba-a0e7-94cde71cb94c","name":"Code","type":"server_js","source":"const url \u003d \"https://docs.google.com/spreadsheets/d/1IjwlzYsCgj0uqrcHEu5eBCcWAYHzkCSrUzXdCfEoTcQ/edit#gid\u003d0\";\nconst ss \u003d SpreadsheetApp.openByUrl(url);\nconst ws \u003d ss.getSheetByName(\"Data\");\n\nvar bmi \u003d 703*ws.getRange(ws.getLastRow(), 2).getValue() / (ws.getRange(ws.getLastRow(), 1).getValue() * ws.getRange(ws.getLastRow(), 1).getValue());\n\nvar list \u003d ws.getRange(1, 1, ws.getLastRow(), 2).getValues;\n\nfunction doGet(e) {\n  var tmp \u003d HtmlService.createTemplateFromFile(\"page\");\n  return tmp.evaluate();\n}\n\nfunction userClicked(userInfo){\n  ws.appendRow([userInfo.uheight, userInfo.uweight, userInfo.uname]);\n  bmi \u003d 703*userInfo.uweight/(userInfo.uheight*userInfo.uheight);\n}\n\nfunction include(filename) {\n  return HtmlService.createHtmlOutputFromFile(filename).getContent();\n}\n\nfunction getTableData() {\n  \n  var data \u003d ws.getRange(2,1, ws.getLastRow()-1, 3).getValues();\n  \n  return data;\n}"},{"id":"6c94406d-e47e-4925-93a2-baabcaddaeca","name":"appsscript","type":"json","source":"{\n  \"timeZone\": \"America/Los_Angeles\",\n  \"dependencies\": {\n  },\n  \"webapp\": {\n    \"access\": \"ANYONE_ANONYMOUS\",\n    \"executeAs\": \"USER_DEPLOYING\"\n  },\n  \"exceptionLogging\": \"STACKDRIVER\",\n  \"runtimeVersion\": \"V8\"\n}"},{"id":"28c7fec8-5af3-4dd4-a0fd-860600fc7add","name":"page","type":"html","source":"\u003c!DOCTYPE html\u003e\n\u003chtml\u003e\n  \u003chead\u003e\n    \u003cbase target\u003d\"_top\"\u003e\n    \u003c?!\u003d include(\"page-css\"); ?\u003e\n  \u003c/head\u003e\n  \u003cbody\u003e\n    \n    \u003ch1\u003eWeight Tracker\u003c/h1\u003e\n    \u003cdiv class\u003d\"form-row\"\u003e\n       \u003clabel\u003eHeight(in inches): \u003c/label\u003e\u003cinput type\u003d\"number\" id\u003d\"height\"\u003e\n    \u003c/div\u003e\n    \u003cdiv class\u003d\"form-row\"\u003e\n       \u003clabel\u003eWeight(in pounds): \u003c/label\u003e\u003cinput type\u003d\"number\" id\u003d\"weight\"\u003e\n    \u003c/div\u003e\n    \u003cdiv class\u003d\"form-row\"\u003e\n       \u003clabel\u003eName: \u003c/label\u003e\u003cinput type\u003d\"test\" id\u003d\"name\"\u003e\n    \u003c/div\u003e\n    \u003cdiv class\u003d\"form-row\"\u003e\n       \u003cbutton id\u003d\"runBtn\"\u003eRecord\u003c/button\u003e\n    \u003c/div\u003e\n    \u003cdiv class\u003d\"form-row\"\u003e\n       \u003cbutton id\u003d\"reload\"\u003eLoad Data\u003c/button\u003e\n    \u003c/div\u003e\n    \n    \u003cscript\u003e\n       \n       document.getElementById(\"reload\").addEventListener(\"click\",refreshPage);\n       \n       function refreshPage(){\n           window.open(\"https://script.google.com/macros/s/AKfycbwUALLQWFdG2Pbi_8_d3zvol3-tDTvdR-gKWb0vp4mhHOGVQ8nL/exec\",\u0027_top\u0027);\n           google.script.run.withSuccessHandler(generateTable).getTableData();\n       }\n    \u003c/script\u003e    \n    \n    \u003cscript\u003e\n    \n      document.getElementById(\"runBtn\").addEventListener(\"click\",doStuff);\n      \n      function doStuff(){\n         var userInfo \u003d {}\n         \n         userInfo.uheight \u003d document.getElementById(\"height\").value;\n         userInfo.uweight \u003d document.getElementById(\"weight\").value;\n         userInfo.uname \u003d document.getElementById(\"name\").value;\n         \n         google.script.run.userClicked(userInfo);\n         google.script.run.doGet(e);\n      } \n    \n    \u003c/script\u003e\n    \n    \u003cdiv class\u003d\"form-row\"\u003e\n       \u003clabel\u003eCurrent BMI: \u003c?\u003d bmi; ?\u003e\u003c/label\u003e\n    \u003c/div\u003e\n    \n    \u003cdiv class\u003d\"form-row\"\u003e\n       \u003ctable\u003e\n        \u003cthead\u003e\n          \u003ctr\u003e\n              \u003cth\u003eHeight  |\u003c/th\u003e\n              \u003cth\u003eWeight  |\u003c/th\u003e\n              \u003cth\u003eName  \u003c/th\u003e\n          \u003c/tr\u003e\n        \u003c/thead\u003e\n\n        \u003ctbody id\u003d\"table-body\"\u003e\n          \n        \u003c/tbody\u003e\n      \u003c/table\u003e\n    \u003c/div\u003e\n    \u003cscript\u003e\n       \n       \n       document.addEventListener(\"DOMContentLoaded\", function() {\n          google.script.run.withSuccessHandler(generateTable).getTableData();\n       });\n       \n       function generateTable(dataArray) {\n          var tbody \u003d document.getElementById(\"table-body\");\n          \n          dataArray.forEach(function(r){\n          \n             var row \u003d document.createElement(\"tr\");\n          \n             var col1 \u003d document.createElement(\"td\");\n             col1.textContent \u003d r[0];\n             \n             var col2 \u003d document.createElement(\"td\");\n             col2.textContent \u003d r[1];\n             \n             var col3 \u003d document.createElement(\"td\");\n             col3.textContent \u003d r[2];\n          \n             row.appendChild(col1);\n             row.appendChild(col2);\n             row.appendChild(col3);\n          \n             tbody.appendChild(row);\n          \n          });  \n       }\n       \n    \u003c/script\u003e\n  \u003c/body\u003e\n\n\u003c/html\u003e\n\n\n"},{"id":"c30672b4-bcd6-41a9-aae8-7f31ce9f70ed","name":"page-css","type":"html","source":"\u003cstyle\u003e\n   .form-row {\n      margin-bottom:15px;\n   }\n\u003c/style\u003e"}]}